
**Редактор куба**

- активная кнопка добавления среза [+] 
    - при наведении отображать дополнительные кнопки:новый срез, $join, $union, $from, $cube
    - при выделении одного или нескольких срезов отбражать подходящие кнопки
- кнопка добавления среза в зависимости от состояния диаграммы (выбранных срезов)
должна изменять логику обработки для каждого типа источника и отображать соответствующие диалоги, если что-то не задано (выбор среза-источника, определение условий пересечения)
- на диаграмме на срезе снизу отображать иконки со структурой запроса
($groupBy, $sort, $filter, $postFilter, $offset/$limit)
- для среза отображать печеречень экспортируемых измерений в виде дополнительных полей,
их два типа: 
    - прямые, определены в самом срезе и присуствуют в $select;
    - экспортируются срезами, которые используются в текущем)
- для среза отображать перечень экпортируемых параметров и значений по-умолчанию (все параметры из запроса среза + параметры используемых срезов)
- сохранять в воркспейсе и обновлять при изменении среза типы выходных полей, экспортируемые измерения и экспортируемые параметры
- оформление перечня измерений:
    - отображать типы и конфликты типов
    - отображать срезы, которым принадлежит измерений
    - добавить переключатель и режим отображения всех полей с их срезами или только измерений
    


**Редактор среза**
- Ошибка: устанавливается ошибочный контекст для поля источника в подзапросе с $from (устанавливает контекст запроса внутри $from, вместо текущего)
      `{
        "$context": "Срез",
        "$from": "cdc7d029613b0faee2589d224975f353/5ac47fe3b1da43bf3e3d44de5b8c130b",
        "$select": {
          "Total PASSER_UNDER_160": {
            "$field": "Total PASSER_UNDER_160"
          },
          "Count INN": {
            "$field": "Count INN"
          },
          "Max Total PASSER_UNDER_160": {
            "$context": "sub_undefined",
            "$from": "cdc7d029613b0faee2589d224975f353/5ac47fe3b1da43bf3e3d44de5b8c130b", // ->> "sub_undefined"
            "$select": {
              "Max Total PASSER_UNDER_160": {
                "$max": {
                  "$field": "Total PASSER_UNDER_160",
                  "$context": "cdc7d029613b0faee2589d224975f353/5ac47fe3b1da43bf3e3d44de5b8c130b" // ->> "sub_undefined"
                }
              }
            }
          }
        }
      }`
- Ошибка: в $joinType нельзя выбрать первый вариант left inner (он устанавливается по дефолту и потом если установть другое значени, то поменять нельзя)
- Ошибка: Не добавляется $gmax
- Ошибка: Не отображается источник,  когда $from именованный запрос
- изменить порядок элементов запроса: $params, $distinct, $select, $groupBy, $filter, $postFilter, $offset, $limit, источник, $views
- поддержать в редакторе срезов Ctrl+Z - в текстовом редакторе это уже реализовано,
достаточно пробросить событие в текстовый редактор, в нем действие отменится и обновятся виджеты автоматически
- поддержать работу с параметрами: 
    1) определение параметров и значений по-умолчанию, оператор запроса `$params: {"${param name}": {$defaultValue: "value", $type: "string"}}`; 
    2) выбор и создание параметров в выражениях, конструкция `${param name}`
- поля-измерения отображать особенным образом, отлично от остальных полей
    - выходные поля главного запроса
    - поля срезов-источников
- Отладить области видимости полей и установку $context:
    - в выражениях поля источника ($from:{},$from:slice,$cube,$join,$union,$recursive)
    - в $groupBy/$sort/$postFilter выходные поля текущего запроса
    - в запросах-выражениях, подзапросах внутри $select, поля источников родительских запросов
    - контексты добавлять только для внешних полей и полей запросов с $join источником,  
    в остальных случаях по умолчанию используется контекст текущего запроса
- добавить в редактор срезов шаблонные-операции:
    1) вынести запрос во вью (поместить запрос в $view и заменить на ссылку)
    2) обернуть запрос вью (заменить запрос на запрос к вью с телом старого запроса)
    3) агрегация 
- чтобы минимизировать/исключить ситуации, когда поля с одинаковыми названиями возвращают разные данные, 
отслеживать названия выходных полей у срезов: 
    - например, добавить ненавязчивую иконку предупреждения (желтый воскл знак), когда
    имя выходного поля среза уже существует в кубе и содержит выражение (не "as-is" поле источника)
    - сообщение типа: "Поле 'INN' уже существует в кубе и вероятно принимает другие значения"     
- упростить отображение классических стандартных структур запроса



      
 **Движок**
- Ошибка в макросах $gr*: если у запроса сложный источник (не $from), то неправильно встраиваются макросы $gr*.
Для обхода ошибки достаточно создать срез и использовать $gmax, либо обернуть запрос во вью
- поддержка создания и вызоыва хранимых процедур $procedure+$select(arguments mapping)
- ведение истории использования измерений и глобальных фильтров
- поддержать веса у провайдеров
- отладить интерпретатор движка на новом AssemblyQuery
- отладить работу MongoDB на новом AssemblyQuery
- [done] подержать в SQL трансляторе прямую трансляцию $views - _translateFieldInternal->checkIsView





