datacube.queryCache.enabled = false
172.16.32.7 - vnc client
https://redmine.avicomp.ru/issues/27453
ssh avicomp@172.16.32.3 - krb datamonitor server



SELECT "Код ВМО", "Родитель", "Наименование", (
	WITH RECURSIVE tree AS (
		SELECT "start"."Код ВМО", "start"."Родитель", "start"."Значение"
		FROM "public"."Справочник муниципалитетов" AS "start"
		WHERE "start"."Код ВМО" = "main"."Код ВМО"

		UNION ALL

		SELECT spr."Код ВМО", spr."Родитель", spr."Значение"
		FROM "public"."Справочник муниципалитетов" as spr
		JOIN tree
		ON spr."Родитель" = tree."Код ВМО"
		-- WHERE spr."Код ВМО" IN (SELECT a."Родитель" FROM "public"."Справочник муниципалитетов" AS a) -- skipLeafs
	)
	SELECT COUNT("Значение") FROM tree
)
FROM "public"."Справочник муниципалитетов" AS "main"
WHERE "Код ВМО" = '0'
GROUP BY  "Код ВМО", "Родитель", "Наименование"